{% extends "dashboard/layout.html" %}

{% block content %}
<div class="bg-white rounded-2xl shadow overflow-hidden">
  <!-- Table Header -->
  <div class="p-4 border-b flex justify-between items-center">
    <h3 class="font-semibold text-gray-800">MIS Invoices</h3>
    <button class="px-4 py-2 text-sm bg-indigo-600 text-white rounded-xl hover:bg-indigo-700">Export</button>
  </div>

  <!-- Table -->
  <div class="p-4">
    <div class="overflow-x-auto">
      <table id="misInvoicesTable" class="w-full text-sm text-left border-collapse">
        <thead class="bg-gray-50 text-gray-600">
          <tr>
            <th class="p-3 font-semibold">ID</th>
            <th class="p-3 font-semibold">Student ID</th>
            <th class="p-3 font-semibold">Reg No</th>
            <th class="p-3 font-semibold">Names</th>
            <th class="p-3 font-semibold">Date</th>
            <th class="p-3 font-semibold">QuickBooks ID</th>
          </tr>
        </thead>
        <tbody>
          {% for inv in invoices %}
          <tr class="border-t hover:bg-gray-50">
            <td class="p-3">{{ inv.id }}</td>
            <td class="p-3">{{ inv.student_id or '-' }}</td>
            <td class="p-3">{{ inv.reg_no or '-' }}</td>
            <td class="p-3">{{ inv.names or '-' }}</td>
            <td class="p-3">{{ inv.date or '-' }}</td>
            <td class="p-3">
              {% if inv.quickbooks_id %}
                <span class="px-2 py-1 text-xs bg-green-100 text-green-700 rounded-full">{{ inv.quickbooks_id }}</span>
              {% else %}
                <span class="px-2 py-1 text-xs bg-red-100 text-red-700 rounded-full">Not Synced</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- DataTables Scripts -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.tailwindcss.min.css">
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.tailwindcss.min.js"></script>

<script>
  $(document).ready(function() {
    $('#misInvoicesTable').DataTable({
      responsive: true,
      pageLength: 10,
      order: [[4, "desc"]], // Order by Date column
      language: {
        search: "_INPUT_",
        searchPlaceholder: "Search invoices..."
      }
    });
  });
</script>
{% endblock %}
